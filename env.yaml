# Cloud CD Environment Configuration
# See: go/ccd for documentation

# Staging environment
staging:
  enabled: true
  region: us-west-2
  
  # Override for staging
  scaling:
    min_replicas: 1
    max_replicas: 3
  
  env:
    ENVIRONMENT: staging
    LOG_LEVEL: DEBUG
  
  # Staging-specific secrets
  secrets:
    SLACK_OAUTH_REDIRECT_URL: "https://goose-slackbot-staging.sqprod.co/slack/oauth_redirect"
  
  # Auto-deploy from main branch
  auto_deploy:
    enabled: true
    branch: main

# Production environment
production:
  enabled: true
  regions:
    - us-west-2
    - us-east-1
  
  # Production scaling
  scaling:
    min_replicas: 3
    max_replicas: 10
  
  env:
    ENVIRONMENT: production
    LOG_LEVEL: INFO
  
  # Production secrets
  secrets:
    SLACK_OAUTH_REDIRECT_URL: "https://goose-slackbot.sqprod.co/slack/oauth_redirect"
  
  # Require approval for production
  auto_deploy:
    enabled: true
    branch: main
    require_approval: true
    approvers:
      - your-ldap-here  # UPDATE WITH YOUR LDAP
  
  # Canary deployment for production
  deployment:
    strategy: canary
    canary:
      enabled: true
      steps:
        - weight: 10
          pause: 10m
        - weight: 50
          pause: 15m
        - weight: 100
  
  # Enhanced monitoring for production
  monitoring:
    alerts:
      - name: critical_error_rate
        condition: error_rate > 3%
        duration: 3m
        severity: critical
      
      - name: high_latency
        condition: p99_latency > 3s
        duration: 5m
        severity: warning
